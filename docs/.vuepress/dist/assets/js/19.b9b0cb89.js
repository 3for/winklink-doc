(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{383:function(t,a,e){"use strict";e.r(a);var s=e(24),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"winklink-价格服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#winklink-价格服务"}},[t._v("#")]),t._v(" WINkLink 价格服务")]),t._v(" "),e("h2",{attrs:{id:"介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),e("p",[t._v("智能合约经常需要对真实世界的代币资产价格做响应，在 DeFi 领域更是如此，资产价格必须和真实世界价格高度对应，\n否则用户和开发者可能承受合约被套利或攻击带来的损失。")]),t._v(" "),e("p",[t._v("WINkLink 价格服务专注于数字货币价格对, 为 DApp 提供准确稳定的外部世界数字货币价格信息。")]),t._v(" "),e("p",[t._v("WINkLink 官方提供了聚合多个 WINkLink 预言机节点价格数据的方案，最终得到稳定的价格服务，称作喂价合约(Price Feed Contract).")]),t._v(" "),e("p",[t._v("本文介绍如何使用和部署 WINkLink 价格服务合约。")]),t._v(" "),e("h2",{attrs:{id:"获取最新价格"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取最新价格"}},[t._v("#")]),t._v(" 获取最新价格")]),t._v(" "),e("p",[t._v("消费者合约中获取最新价格数据需要引入 "),e("code",[t._v("AggregatorInterface")]),t._v(", 该接口定义了喂价服务对外提供的接口。")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("pragma solidity "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("^")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v(".0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AggregatorInterface")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("latestAnswer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" external view "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("returns")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int256"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("latestTimestamp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" external view "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("returns")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint256"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("latestRound")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" external view "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("returns")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint256"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAnswer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("uint256 roundId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" external view "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("returns")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("int256"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getTimestamp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("uint256 roundId")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" external view "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("returns")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("uint256"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\ncontract PriceConsumer "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    AggregatorInterface internal priceFeed"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Price Aggregator Address: TYZxQSHAhxGgUWzxYEZAohvWc9cQWXtNBt\n     */")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        priceFeed "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("AggregatorInterface")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xF7e52418572834722ED87E9425d673FEdBD55a0e")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n     * Returns the latest price\n     */")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("getLatestPrice")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" view "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("returns")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("int")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// If the round is not complete yet, timestamp is 0")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("priceFeed"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("latestTimestamp")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Round not complete"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" priceFeed"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("latestAnswer")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h3",{attrs:{id:"历史价格"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#历史价格"}},[t._v("#")]),t._v(" 历史价格")]),t._v(" "),e("p",[t._v("由 "),e("code",[t._v("AggregatorInterface")]),t._v(" 接口函数列表，通过 "),e("code",[t._v("getAnswer(uint256 roundId)")]),t._v(" 可以获取历史价格信息。对应的时间戳通过\n"),e("code",[t._v("getTimestamp(uint256 roundId)")]),t._v(" 获得。")]),t._v(" "),e("h2",{attrs:{id:"喂价合约"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#喂价合约"}},[t._v("#")]),t._v(" 喂价合约")]),t._v(" "),e("h3",{attrs:{id:"主网"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#主网"}},[t._v("#")]),t._v(" 主网")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Pair")]),t._v(" "),e("th",[t._v("喂价合约地址")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("TRX-USD")]),t._v(" "),e("td",[e("code",[t._v("TNwqbPTDLgGQVfLz75NnaMfsrVHbKQBuCo")])])]),t._v(" "),e("tr",[e("td",[t._v("JST-USD")]),t._v(" "),e("td",[e("code",[t._v("TAKipCT5xdCKkB8BTEGV8A9pysbnLSbK4v")])])]),t._v(" "),e("tr",[e("td",[t._v("SUNOLD-USD")]),t._v(" "),e("td",[e("code",[t._v("THVdX8xZfjUtZEHFYDzZhQF6HzwjBeivo6")])])]),t._v(" "),e("tr",[e("td",[t._v("BTC-USD")]),t._v(" "),e("td",[e("code",[t._v("TFBF8bBpQbrhzEZbTyXXPmB3a4tXmqqk7Y")])])]),t._v(" "),e("tr",[e("td",[t._v("WIN-USD")]),t._v(" "),e("td",[e("code",[t._v("TBdQHu2hd5obmikZWn4KkuqmxaN1LCEp4U")])])]),t._v(" "),e("tr",[e("td",[t._v("DICE-USD")]),t._v(" "),e("td",[e("code",[t._v("TYQh9z6g2aGB1mQwRzGvdFphkt1nEjAMY2")])])]),t._v(" "),e("tr",[e("td",[t._v("USDJ-USD")]),t._v(" "),e("td",[e("code",[t._v("TBbg182ovR4Ra282MERwDwiyCVS2gtjF8g")])])]),t._v(" "),e("tr",[e("td",[t._v("JST-TRX")]),t._v(" "),e("td",[e("code",[t._v("TCf4vSQLbHBFKzezHudEpvnhJ5GNQ6F2Ex")])])]),t._v(" "),e("tr",[e("td",[t._v("WIN-TRX")]),t._v(" "),e("td",[e("code",[t._v("TR6LAm2T1kdqgZBYWBtyS9HXs11KhvK5cq")])])]),t._v(" "),e("tr",[e("td",[t._v("DICE-TRX")]),t._v(" "),e("td",[e("code",[t._v("TLjFYyi7Va3nUfEgUiL5S1YgLqPYjv7aF4")])])]),t._v(" "),e("tr",[e("td",[t._v("LIVE-USD")]),t._v(" "),e("td",[e("code",[t._v("TBpcwZo2Vk825nss6WSSdhVz7NWqt5aS1U")])])]),t._v(" "),e("tr",[e("td",[t._v("USDT-USD")]),t._v(" "),e("td",[e("code",[t._v("TZ8u8sz1ToRfGaQ5JbYNwEiuRTXUBe9tFx")])])]),t._v(" "),e("tr",[e("td",[t._v("SUNOLD-TRX")]),t._v(" "),e("td",[e("code",[t._v("TE14YrYpFtrPqxVSQ6V4WUsTniwfdcxbAR")])])]),t._v(" "),e("tr",[e("td",[t._v("BTC-TRX")]),t._v(" "),e("td",[e("code",[t._v("TGNLjD435kXGoHi9JiFvrDr9SQE6eyu91X")])])]),t._v(" "),e("tr",[e("td",[t._v("USDJ-TRX")]),t._v(" "),e("td",[e("code",[t._v("TDQA9eG9tmS7JbbFbzfcxvQn1Z9xuPt62V")])])]),t._v(" "),e("tr",[e("td",[t._v("USDT-TRX")]),t._v(" "),e("td",[e("code",[t._v("TWBz6RPTbgEu9qY72NNRSZprD88DnHzizw")])])]),t._v(" "),e("tr",[e("td",[t._v("BTT-USD")]),t._v(" "),e("td",[e("code",[t._v("THNCvWFdV3Qe2SeFWzz95XvjjsmBPtHi6q")])])]),t._v(" "),e("tr",[e("td",[t._v("BTT-TRX")]),t._v(" "),e("td",[e("code",[t._v("TSEu2g6oD5ukHYvKbn2shc9mdpELySgbv9")])])]),t._v(" "),e("tr",[e("td",[t._v("ETH-TRX")]),t._v(" "),e("td",[e("code",[t._v("TENtY6C9WiCpGenjUFwf33DYTcrV7GEZuh")])])])])]),t._v(" "),e("h3",{attrs:{id:"nile-测试网"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nile-测试网"}},[t._v("#")]),t._v(" Nile 测试网")]),t._v(" "),e("ul",[e("li",[t._v("合约列表"),e("a",{attrs:{href:"http://47.252.73.5:3300/#/solutions",target:"_blank",rel:"noopener noreferrer"}},[t._v("查看页面"),e("OutboundLink")],1)]),t._v(" "),e("li",[t._v("WIN 代币合约地址: "),e("code",[t._v("TNDSHKGBmgRx9mDYA9CnxPx55nu672yQw2")])]),t._v(" "),e("li",[t._v("WinkMid 合约地址: "),e("code",[t._v("TFbci8j8Ja3hMLPsupsuYcUMsgXniG1TWb")])])]),t._v(" "),e("p",[t._v("价格服务合约地址列表：")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("Pair")]),t._v(" "),e("th",[t._v("喂价合约地址")]),t._v(" "),e("th",[t._v("Oracle 合约地址")]),t._v(" "),e("th",[t._v("job id")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("TRX-USD")]),t._v(" "),e("td",[e("code",[t._v("TAL6RWymPLepKsLGCzWPUTKQQcWFsuHfNE")])]),t._v(" "),e("td",[e("code",[t._v("TRDh1Hi4Hugb4J7DiQfvW6mCf8xGTEsQ66")]),e("br"),e("code",[t._v("TVKZGaPgSg8r3Pjyd5LsvbYEM5WRwfMetc")]),e("br"),e("code",[t._v("TQdYZe2XK2MwXx4PgDLuTWy4rhsc1A87wu")]),e("br"),e("code",[t._v("TFKq9ZyySXFe1iCtWyYAFbJFCV9uEt5ghb")]),e("br"),e("code",[t._v("TEx4rxit3Au6ek5avy4Aiy1N6Fyt38AS3o")])]),t._v(" "),e("td",[e("code",[t._v("bb347a9a63324fd995a7159cb0c8348a")]),e("br"),e("code",[t._v("40691f5fd4b64ab4a5442477ed484d80")]),e("br"),e("code",[t._v("f7ccb652cc254a19b0b954c49af25926")]),e("br"),e("code",[t._v("38cd68072a6c4a0ca05e9b91976cf4f1")]),e("br"),e("code",[t._v("328697ef599043e1a301ae985d06aabf")])])]),t._v(" "),e("tr",[e("td",[t._v("JST-USD")]),t._v(" "),e("td",[e("code",[t._v("TYr8nvS9BUbi9eLXNQpUMbxdvwYpoWn3ho")])]),t._v(" "),e("td",[e("code",[t._v("TRDh1Hi4Hugb4J7DiQfvW6mCf8xGTEsQ66")]),e("br"),e("code",[t._v("TVKZGaPgSg8r3Pjyd5LsvbYEM5WRwfMetc")]),e("br"),e("code",[t._v("TQdYZe2XK2MwXx4PgDLuTWy4rhsc1A87wu")]),e("br"),e("code",[t._v("TFKq9ZyySXFe1iCtWyYAFbJFCV9uEt5ghb")])]),t._v(" "),e("td",[e("code",[t._v("b09f188f336844e2b4f93ec7c2cc238f")]),e("br"),e("code",[t._v("ca97ef49175a44078c2c2933287915fd")]),e("br"),e("code",[t._v("1f26180c61824d25b822d76972f16d7d")]),e("br"),e("code",[t._v("c10608a577214eba904a7673d4e97fca")])])]),t._v(" "),e("tr",[e("td",[t._v("SUNOLD-USD")]),t._v(" "),e("td",[e("code",[t._v("TWWjBHU3KkuV65rTVkA4UrCrGwBRTXs3KK")])]),t._v(" "),e("td",[e("code",[t._v("TRDh1Hi4Hugb4J7DiQfvW6mCf8xGTEsQ66")]),e("br"),e("code",[t._v("TVKZGaPgSg8r3Pjyd5LsvbYEM5WRwfMetc")]),e("br"),e("code",[t._v("TQdYZe2XK2MwXx4PgDLuTWy4rhsc1A87wu")]),e("br"),e("code",[t._v("TFKq9ZyySXFe1iCtWyYAFbJFCV9uEt5ghb")])]),t._v(" "),e("td",[e("code",[t._v("884366e5e9e441d6a792f77907778345")]),e("br"),e("code",[t._v("e109e9a1dc26475a834446509468ac59")]),e("br"),e("code",[t._v("d528c7c0d4784d0d9b53b932694b44fe")]),e("br"),e("code",[t._v("3f0a614654704ec3b50da1612b478ecb")])])]),t._v(" "),e("tr",[e("td",[t._v("BTC-USD")]),t._v(" "),e("td",[e("code",[t._v("TYY5GdNvHN8NVY6MYtgEPwx15pyUmLEw5J")])]),t._v(" "),e("td",[e("code",[t._v("TRDh1Hi4Hugb4J7DiQfvW6mCf8xGTEsQ66")]),e("br"),e("code",[t._v("TVKZGaPgSg8r3Pjyd5LsvbYEM5WRwfMetc")]),e("br"),e("code",[t._v("TQdYZe2XK2MwXx4PgDLuTWy4rhsc1A87wu")]),e("br"),e("code",[t._v("TFKq9ZyySXFe1iCtWyYAFbJFCV9uEt5ghb")]),e("br"),e("code",[t._v("TEx4rxit3Au6ek5avy4Aiy1N6Fyt38AS3o")])]),t._v(" "),e("td",[e("code",[t._v("5a0f83ca61d74bad961acd0912adc53f")]),e("br"),e("code",[t._v("4f929a07ad1b4efba8fa686ad9641738")]),e("br"),e("code",[t._v("7c2457a191bf43488419adf7c48d4ff0")]),e("br"),e("code",[t._v("83d851c6627e4fed8c0e24292e1dc42f")]),e("br"),e("code",[t._v("1fc45a68c7f346229f08aee1982daa0e")])])]),t._v(" "),e("tr",[e("td",[t._v("WIN-USD")]),t._v(" "),e("td",[e("code",[t._v("TGPDYFAcFx8ZXf7sGTLwbvsDh8FdEnsNyN")])]),t._v(" "),e("td",[e("code",[t._v("TVKZGaPgSg8r3Pjyd5LsvbYEM5WRwfMetc")]),e("br"),e("code",[t._v("TFKq9ZyySXFe1iCtWyYAFbJFCV9uEt5ghb")])]),t._v(" "),e("td",[e("code",[t._v("2f6c1f3dbb634e60910da542df34a94a")]),e("br"),e("code",[t._v("ca4821f3c5ef4b2cb8ee330a6f634520")])])]),t._v(" "),e("tr",[e("td",[t._v("DICE-USD")]),t._v(" "),e("td",[e("code",[t._v("TS8fAMLNnbWgNyXz6queFHR7HfZkhAeppK")])]),t._v(" "),e("td",[e("code",[t._v("TFKq9ZyySXFe1iCtWyYAFbJFCV9uEt5ghb")])]),t._v(" "),e("td",[e("code",[t._v("ad7888ed606d4b249edd298791f0c2d7")])])]),t._v(" "),e("tr",[e("td",[t._v("USDJ-USDT")]),t._v(" "),e("td",[e("code",[t._v("TMmh7ZJkXpz4fE9FyFvRByMwvBE5Z2cRj8")])]),t._v(" "),e("td",[e("code",[t._v("TFKq9ZyySXFe1iCtWyYAFbJFCV9uEt5ghb")])]),t._v(" "),e("td",[e("code",[t._v("b0ec07370a734d0cbdfabf6fe0e903c0")])])]),t._v(" "),e("tr",[e("td",[t._v("JST-TRX")]),t._v(" "),e("td",[e("code",[t._v("THs9f15hC6r6rWzAE2NBUyiX2SetwDCnYD")])]),t._v(" "),e("td",[e("code",[t._v("TFKq9ZyySXFe1iCtWyYAFbJFCV9uEt5ghb")])]),t._v(" "),e("td",[e("code",[t._v("4ac87bf722da4659ae9989c2ad7646ae")])])]),t._v(" "),e("tr",[e("td",[t._v("WIN-TRX")]),t._v(" "),e("td",[e("code",[t._v("TReQocbkKBbGrgzoYWQ8bJnCNG1LGehwZw")])]),t._v(" "),e("td",[e("code",[t._v("TFKq9ZyySXFe1iCtWyYAFbJFCV9uEt5ghb")])]),t._v(" "),e("td",[e("code",[t._v("febfcef0ce234fbdabaad191f2c4c542")])])]),t._v(" "),e("tr",[e("td",[t._v("DICE-TRX")]),t._v(" "),e("td",[e("code",[t._v("TSejCUHkk5gD2UjtoPt3n3rdByTbKLac4Q")])]),t._v(" "),e("td",[e("code",[t._v("TFKq9ZyySXFe1iCtWyYAFbJFCV9uEt5ghb")])]),t._v(" "),e("td",[e("code",[t._v("c22e485bb31a4680b7eff3dc590d8c8f")])])])])]),t._v(" "),e("h3",{attrs:{id:"申请新交易对"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#申请新交易对"}},[t._v("#")]),t._v(" 申请新交易对")]),t._v(" "),e("p",[t._v("如果您需要 WINkLink 提供新的交易对，请填写并提交"),e("a",{attrs:{href:"https://docs.google.com/forms/d/e/1FAIpQLSdPqV3oWV87FYdox5D_J6BIve7R5eG0cHIGsh49r8gg_QiNeQ/viewform",target:"_blank",rel:"noopener noreferrer"}},[t._v("申请表单"),e("OutboundLink")],1),t._v("。")]),t._v(" "),e("h2",{attrs:{id:"部署价格服务"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#部署价格服务"}},[t._v("#")]),t._v(" 部署价格服务")]),t._v(" "),e("p",[t._v("开发者也可以部署自己的价格服务，自定义价格来源和最少响应预言机个数。")]),t._v(" "),e("p",[t._v("生产环境情况下，应该需要多个预言机节点来喂价，然后通过聚合得到一个最终的价格。\n但在测试的流程下，我们暂且只设置一个节点来喂价。简化测试展示流程。")]),t._v(" "),e("h3",{attrs:{id:"部署喂价合约"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#部署喂价合约"}},[t._v("#")]),t._v(" 部署喂价合约")]),t._v(" "),e("p",[t._v("TronUser 合约是 WINkLink 官方推出的聚合价格服务合约模板，该合约实现了 "),e("code",[t._v("AggregatorInterface")]),t._v(" 接口，开发者可以直接使用。")]),t._v(" "),e("p",[t._v("合约代码位于 "),e("a",{attrs:{href:"https://github.com/wink-link/winklink/blob/master/tvm-contracts/v1.0/TronUser.sol",target:"_blank",rel:"noopener noreferrer"}},[t._v("TronUser.sol"),e("OutboundLink")],1)]),t._v(" "),e("p",[t._v("部署 TronUser 合约时需要在构造函数提供 WIN 代币地址和 WinkMid 合约地址。例如 Nile 测试网中，需要提供\n"),e("code",[t._v("(TNDSHKGBmgRx9mDYA9CnxPx55nu672yQw2, TFbci8j8Ja3hMLPsupsuYcUMsgXniG1TWb)")]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"添加预言机节点以及-job-id"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#添加预言机节点以及-job-id"}},[t._v("#")]),t._v(" 添加预言机节点以及 job ID")]),t._v(" "),e("p",[t._v("TronUser 合约部署完毕后，合约 owner 需要为其设置所聚合请求的预言机服务列表。使用如下接口：")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateRequestDetails")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("uint128 _paymentAmount"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" uint128 _minimumResponses"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" address"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" _oracles"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" bytes32"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" _jobIds")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("其中 "),e("code",[t._v("_paymentAmount")]),t._v(" 表示每次更新调用所支付代币数量。")]),t._v(" "),e("p",[e("code",[t._v("_oracles")]),t._v(" 和 "),e("code",[t._v("_jobIds")]),t._v(" 是一对等长列表，每组对应一个 WINkLink 预言机 job 唯一标识。")]),t._v(" "),e("p",[e("code",[t._v("_minimumResponses")]),t._v(" 表示需要的最少响应预言机个数，必须大于等于 "),e("code",[t._v("_oracles")]),t._v(" 长度。\n例如可以设置要求至少 5/10 个预言机响应后，本次更新值才有效。")]),t._v(" "),e("p",[t._v("示例调用 "),e("code",[t._v('updateRequestDetails(10, 1, ["TR9jYcLWAcQfbKcP5oau1ccSbeW7mdnqg8"], ["db22ccf4b4a14d0cae2a0757632e425d"])')]),t._v(".")]),t._v(" "),e("h3",{attrs:{id:"为合约转入-win-代币"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#为合约转入-win-代币"}},[t._v("#")]),t._v(" 为合约转入 WIN 代币")]),t._v(" "),e("p",[t._v("TronUser 合约需要使用 "),e("code",[t._v("transferAndCall")]),t._v(" 调用 Oracle 合约，所以合约账户需要有足够的 WIN 代币。\n可以通过转账或测试网水龙头为合约转入若干 WIN 代币。")]),t._v(" "),e("h3",{attrs:{id:"调用喂价合约"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#调用喂价合约"}},[t._v("#")]),t._v(" 调用喂价合约")]),t._v(" "),e("h4",{attrs:{id:"更新价格-requestrateupdate"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#更新价格-requestrateupdate"}},[t._v("#")]),t._v(" 更新价格 requestRateUpdate")]),t._v(" "),e("p",[t._v("使用如下接口请求 WINkLink 预言机节点从外部数据源获取最新价格：")]),t._v(" "),e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestRateUpdate")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("returns")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("bytes32"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),e("p",[t._v("接口返回 "),e("code",[t._v("requestID")]),t._v(". 通过 "),e("code",[t._v("requestID")]),t._v(" 可以取消更新价格请求。")]),t._v(" "),e("h4",{attrs:{id:"获取最新价格-latestanswer"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#获取最新价格-latestanswer"}},[t._v("#")]),t._v(" 获取最新价格 latestAnswer")]),t._v(" "),e("p",[t._v("使用 "),e("code",[t._v("AggregatorInterface")]),t._v(" 中的 "),e("code",[t._v("latestAnswer()")]),t._v(" 调用可以获取最新价格。")]),t._v(" "),e("p",[t._v("TronScan 的合约信息页面可以直接调用该方法获得最新值。")])])}),[],!1,null,null,null);a.default=n.exports}}]);